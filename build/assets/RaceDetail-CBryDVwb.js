import{c as h,j as e,S as P,B as u,C as i,a as d,b as c,v as n,w as o,x,e as m,T as G}from"./index-D5VgfkZI.js";import{r}from"./react-vendor-CoRTCUxX.js";import{B as R}from"./badge-B_Kj0s6v.js";import{H as b,F as v}from"./Footer-DE8fib7i.js";import{P as W}from"./progress-BsjczCxA.js";import{A as F,S as g}from"./separator-CbRWdVV3.js";import{A as I,a as L,b as V}from"./avatar-CM6BsUSu.js";import{b as Z,u as J}from"./router-vendor-BLkE0Fw5.js";import{M as K}from"./map-pin-DQ_pM_nY.js";import{C as Q}from"./calendar-DBRRU35f.js";import{U as E,T as X}from"./users-C6XVKek0.js";import{M as Y,A as _}from"./medal-cUwT7ls0.js";import{Z as ee}from"./zap-CISv6Qpn.js";import{T as D}from"./thermometer-C9cEuB3J.js";import"./user-ClgHmQx_.js";/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const se=h("LayoutGrid",[["rect",{width:"7",height:"7",x:"3",y:"3",rx:"1",key:"1g98yp"}],["rect",{width:"7",height:"7",x:"14",y:"3",rx:"1",key:"6d4xhi"}],["rect",{width:"7",height:"7",x:"14",y:"14",rx:"1",key:"nxv5o0"}],["rect",{width:"7",height:"7",x:"3",y:"14",rx:"1",key:"1bb6yr"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const te=h("LayoutList",[["rect",{width:"7",height:"7",x:"3",y:"3",rx:"1",key:"1g98yp"}],["rect",{width:"7",height:"7",x:"3",y:"14",rx:"1",key:"1bb6yr"}],["path",{d:"M14 4h7",key:"3xa0d5"}],["path",{d:"M14 9h7",key:"1icrd9"}],["path",{d:"M14 15h7",key:"1mj8o2"}],["path",{d:"M14 20h7",key:"11slyb"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ae=h("Maximize",[["path",{d:"M8 3H5a2 2 0 0 0-2 2v3",key:"1dcmit"}],["path",{d:"M21 8V5a2 2 0 0 0-2-2h-3",key:"1e4gt3"}],["path",{d:"M3 16v3a2 2 0 0 0 2 2h3",key:"wsl5sc"}],["path",{d:"M16 21h3a2 2 0 0 0 2-2v-3",key:"18trek"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const re=h("Minimize",[["path",{d:"M8 3v3a2 2 0 0 1-2 2H3",key:"hohbtr"}],["path",{d:"M21 8h-3a2 2 0 0 1-2-2V3",key:"5jw1f3"}],["path",{d:"M3 16h3a2 2 0 0 1 2 2v3",key:"198tvr"}],["path",{d:"M16 21v-3a2 2 0 0 1 2-2h3",key:"ph8mxp"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const le=h("Wind",[["path",{d:"M12.8 19.6A2 2 0 1 0 14 16H2",key:"148xed"}],["path",{d:"M17.5 8a2.5 2.5 0 1 1 2 4H2",key:"1u4tom"}],["path",{d:"M9.8 4.4A2 2 0 1 1 11 8H2",key:"75valh"}]]),Ce=()=>{const{id:f}=Z(),y=J(),[t,N]=r.useState(null),[H,w]=r.useState(!0),[k,C]=r.useState(!1),[M,S]=r.useState(!1),[ie,de]=r.useState("pilotos"),[p,q]=r.useState(!1),[ce,ne]=r.useState(!0),[j,T]=r.useState("grid"),A=r.useRef(null),z=r.useRef(null);r.useEffect(()=>{f&&fetch(`/api/races/${f}/enriched`).then(s=>s.json()).then(s=>{s&&s.id?N(s):N(null),w(!1)}).catch(s=>{console.error("Erro ao carregar corrida:",s),w(!1)})},[f]),r.useEffect(()=>{t&&fetch("/api/session").then(s=>s.json()).then(s=>{s.user&&C(t.participants.some(a=>a.username===s.user.username))}).catch(s=>console.error("Erro ao verificar sessÃ£o:",s))},[t]);const B=s=>s==="live"?"bg-red-500 animate-pulse":s==="completed"?"bg-green-500":"bg-blue-500",$=async()=>{if(t){S(!0);try{const a=await(await fetch(`/api/races/${t.id}/register`,{method:"POST",headers:{"Content-Type":"application/json"},credentials:"include"})).json();a.ok?(C(!0),fetch(`/api/races/${t.id}/enriched`).then(l=>l.json()).then(l=>N(l))):alert(a.message||"Erro ao se inscrever")}catch(s){console.error("Erro ao inscrever:",s),alert("Erro ao se inscrever")}S(!1)}},O=()=>{const s=A.current;s&&(p?document.exitFullscreen&&document.exitFullscreen():s.requestFullscreen&&s.requestFullscreen().catch(a=>{console.error("Erro ao ativar fullscreen:",a)}),q(!p))};return H?e.jsxs("div",{className:"min-h-screen bg-background",children:[e.jsx(b,{}),e.jsxs("div",{className:"container py-8",children:[e.jsx(P,{className:"h-12 w-full mb-4"}),e.jsx(P,{className:"h-64 w-full"})]}),e.jsx(v,{})]}):t?e.jsxs("div",{className:"min-h-screen bg-background",children:[e.jsx(b,{}),e.jsxs("main",{className:"container py-8",children:[e.jsxs(u,{variant:"ghost",onClick:()=>y("/races"),className:"mb-6",children:[e.jsx(F,{className:"h-4 w-4 mr-2"}),"Voltar para corridas"]}),e.jsx("div",{className:"mb-8",children:e.jsxs("div",{className:"flex items-start justify-between mb-4 gap-4 flex-wrap",children:[e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("h1",{className:"text-4xl font-bold mb-3",children:t.title}),e.jsxs("div",{className:"flex flex-wrap items-center gap-3 text-muted-foreground",children:[e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(K,{className:"h-4 w-4 flex-shrink-0"}),e.jsx("span",{children:t.track})]}),e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(Q,{className:"h-4 w-4 flex-shrink-0"}),e.jsxs("span",{children:[new Date(t.date).toLocaleDateString("pt-BR")," Ã s ",t.time]})]}),e.jsx(R,{className:B(t.status),children:t.status==="live"?"ðŸ”´ AO VIVO":t.status==="completed"?"âœ“ Finalizado":"â± PrÃ³xima"})]})]}),e.jsx(u,{size:"lg",onClick:$,disabled:k||M,className:"flex-shrink-0",children:k?"âœ“ Inscrito":M?"Inscrevendo...":"ðŸ Inscrever-se"})]})}),e.jsxs("div",{className:"grid lg:grid-cols-4 gap-8",ref:A,children:[e.jsx("div",{className:"lg:col-span-3",children:e.jsxs(i,{className:"glass-card gradient-border",children:[e.jsxs(d,{className:"flex flex-row items-center justify-between",children:[e.jsxs(c,{className:"text-2xl flex items-center gap-2",children:[e.jsx(E,{className:"h-6 w-6"}),"Pilotos Inscritos (",t.participants.length,")"]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs("div",{className:"flex border rounded-lg p-1 bg-muted/50",children:[e.jsx("button",{onClick:()=>T("grid"),className:`p-1 rounded transition-colors ${j==="grid"?"bg-primary text-primary-foreground":"text-muted-foreground"}`,children:e.jsx(se,{className:"h-4 w-4"})}),e.jsx("button",{onClick:()=>T("list"),className:`p-1 rounded transition-colors ${j==="list"?"bg-primary text-primary-foreground":"text-muted-foreground"}`,children:e.jsx(te,{className:"h-4 w-4"})})]}),e.jsxs(n,{children:[e.jsx(o,{asChild:!0,children:e.jsx(u,{variant:"ghost",size:"sm",onClick:O,children:p?e.jsx(re,{className:"h-4 w-4"}):e.jsx(ae,{className:"h-4 w-4"})})}),e.jsx(x,{children:"Fullscreen"})]})]})]}),e.jsx(m,{children:t.participants&&t.participants.length>0?e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4 bg-gradient-to-r from-primary/10 to-secondary/10 p-4 rounded-lg mb-6 border border-primary/20",children:[e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"text-xs text-muted-foreground font-semibold",children:"Pilotos Inscritos"}),e.jsx("div",{className:"text-2xl font-bold text-primary",children:t.participants.length})]}),e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"text-xs text-muted-foreground font-semibold",children:"Voltas"}),e.jsx("div",{className:"text-2xl font-bold text-secondary",children:t.laps})]}),e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"text-xs text-muted-foreground font-semibold",children:"DuraÃ§Ã£o"}),e.jsx("div",{className:"text-2xl font-bold text-accent",children:t.duration})]}),e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"text-xs text-muted-foreground font-semibold",children:"Categoria"}),e.jsx("div",{className:"text-lg font-bold truncate",children:t.category||"N/A"})]})]}),j==="grid"&&e.jsx("div",{className:"grid gap-4 md:grid-cols-2 lg:grid-cols-3",children:t.participants.map((s,a)=>e.jsxs("div",{className:"p-4 rounded-lg border border-border/50 bg-card/50 hover:bg-card/80 hover:border-primary/50 transition-all duration-200 group",children:[e.jsxs("div",{className:"flex items-start justify-between mb-3",children:[e.jsx("div",{className:"flex items-center gap-2",children:e.jsx("div",{className:`w-8 h-8 rounded-full flex items-center justify-center font-bold text-white ${a===0?"bg-yellow-500":a===1?"bg-gray-400":a===2?"bg-amber-600":"bg-blue-500"}`,children:a+1})}),e.jsx(R,{variant:"outline",className:"text-xs",children:new Date(s.registeredAt).toLocaleDateString("pt-BR")})]}),e.jsxs("div",{className:"flex items-center gap-3 mb-3",children:[e.jsxs(I,{className:"h-12 w-12 border-2 border-primary/20",children:[e.jsx(L,{src:s.avatar||void 0,alt:s.displayName}),e.jsx(V,{children:s.displayName.substring(0,2).toUpperCase()})]}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("h4",{className:"font-semibold truncate text-sm",children:s.displayName}),e.jsx("p",{className:"text-xs text-muted-foreground truncate",children:s.team})]})]}),e.jsxs("div",{className:"grid grid-cols-3 gap-2 mb-3 bg-muted/30 p-2 rounded",children:[e.jsxs(n,{children:[e.jsx(o,{children:e.jsxs("div",{className:"text-center text-xs",children:[e.jsx(X,{className:"h-3 w-3 mx-auto mb-1 text-yellow-500"}),e.jsx("div",{className:"font-bold",children:s.stats.wins})]})}),e.jsx(x,{children:"VitÃ³rias"})]}),e.jsxs(n,{children:[e.jsx(o,{children:e.jsxs("div",{className:"text-center text-xs",children:[e.jsx(Y,{className:"h-3 w-3 mx-auto mb-1 text-green-500"}),e.jsx("div",{className:"font-bold",children:s.stats.podiums})]})}),e.jsx(x,{children:"PÃ³dios"})]}),e.jsxs(n,{children:[e.jsx(o,{children:e.jsxs("div",{className:"text-center text-xs",children:[e.jsx(ee,{className:"h-3 w-3 mx-auto mb-1 text-orange-500"}),e.jsx("div",{className:"font-bold",children:s.stats.points})]})}),e.jsx(x,{children:"Pontos"})]})]}),s.achievements&&s.achievements.length>0&&e.jsxs("div",{className:"flex flex-wrap gap-1",children:[s.achievements.slice(0,3).map((l,U)=>e.jsxs(n,{children:[e.jsx(o,{children:e.jsx(_,{className:"h-4 w-4 text-amber-500"})}),e.jsx(x,{children:l.name||"Conquista"})]},U)),s.achievements.length>3&&e.jsxs("span",{className:"text-xs text-muted-foreground ml-auto",children:["+",s.achievements.length-3]})]})]},s.username))}),j==="list"&&e.jsx("div",{className:"overflow-x-auto rounded-lg border",ref:z,children:e.jsxs("table",{className:"w-full text-sm",children:[e.jsx("thead",{className:"bg-muted/50",children:e.jsxs("tr",{children:[e.jsx("th",{className:"p-3 text-left",children:"Pos"}),e.jsx("th",{className:"p-3 text-left",children:"Piloto"}),e.jsx("th",{className:"p-3 text-center",children:"V"}),e.jsx("th",{className:"p-3 text-center",children:"P"}),e.jsx("th",{className:"p-3 text-center",children:"Pts"}),e.jsx("th",{className:"p-3 text-left",children:"Equipe"}),e.jsx("th",{className:"p-3 text-left",children:"InscriÃ§Ã£o"})]})}),e.jsx("tbody",{children:t.participants.map((s,a)=>e.jsxs("tr",{className:"border-b hover:bg-muted/20 transition-colors",children:[e.jsx("td",{className:"p-3 font-bold",children:e.jsx("div",{className:`w-8 h-8 rounded-full flex items-center justify-center font-bold text-white ${a===0?"bg-yellow-500":a===1?"bg-gray-400":a===2?"bg-amber-600":"bg-blue-500"}`,children:a+1})}),e.jsx("td",{className:"p-3",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs(I,{className:"h-8 w-8",children:[e.jsx(L,{src:s.avatar||void 0}),e.jsx(V,{children:s.displayName.substring(0,1)})]}),e.jsx("span",{className:"font-medium",children:s.displayName})]})}),e.jsx("td",{className:"p-3 text-center font-semibold text-yellow-500",children:s.stats.wins}),e.jsx("td",{className:"p-3 text-center font-semibold text-green-500",children:s.stats.podiums}),e.jsx("td",{className:"p-3 text-center font-semibold text-orange-500",children:s.stats.points}),e.jsx("td",{className:"p-3 text-muted-foreground",children:s.team}),e.jsx("td",{className:"p-3 text-muted-foreground text-xs",children:new Date(s.registeredAt).toLocaleDateString("pt-BR")})]},s.username))})]})})]}):e.jsxs("div",{className:"text-center py-12 text-muted-foreground",children:[e.jsx(E,{className:"h-12 w-12 mx-auto mb-3 opacity-50"}),e.jsx("p",{className:"text-lg font-medium",children:"Nenhum piloto inscrito ainda"}),e.jsx("p",{className:"text-sm",children:"Seja o primeiro a se inscrever!"})]})})]})}),e.jsxs("div",{className:"lg:col-span-1 space-y-4",children:[e.jsxs(i,{className:"glass-card",children:[e.jsx(d,{children:e.jsx(c,{className:"text-lg",children:"Detalhes da Corrida"})}),e.jsxs(m,{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-xs font-semibold text-muted-foreground mb-1",children:"Pista"}),e.jsx("div",{className:"font-semibold text-sm",children:t.track})]}),e.jsx(g,{}),e.jsxs("div",{children:[e.jsx("div",{className:"text-xs font-semibold text-muted-foreground mb-1",children:"Categoria"}),e.jsx("div",{className:"font-semibold text-sm",children:t.category||"N/A"})]}),e.jsx(g,{}),e.jsxs("div",{children:[e.jsx("div",{className:"text-xs font-semibold text-muted-foreground mb-1",children:"Voltas"}),e.jsx("div",{className:"font-semibold text-sm",children:t.laps})]}),e.jsx(g,{}),e.jsxs("div",{children:[e.jsx("div",{className:"text-xs font-semibold text-muted-foreground mb-1",children:"DuraÃ§Ã£o"}),e.jsx("div",{className:"font-semibold text-sm",children:t.duration})]}),e.jsx(g,{}),e.jsxs("div",{children:[e.jsx("div",{className:"text-xs font-semibold text-muted-foreground mb-1",children:"Inscritos"}),e.jsx(W,{value:t.participants.length/Number(t.maxParticipants||20)*100,className:"h-2 mb-1"}),e.jsxs("div",{className:"font-semibold text-sm",children:[t.participants.length,"/",t.maxParticipants||20]})]})]})]}),t.trackTemp&&e.jsxs(i,{className:"glass-card",children:[e.jsx(d,{children:e.jsx(c,{className:"text-lg",children:"Clima"})}),e.jsxs(m,{className:"space-y-3",children:[e.jsxs("div",{className:"flex items-center gap-3 p-2 bg-muted/30 rounded",children:[e.jsx(D,{className:"h-5 w-5 text-red-500"}),e.jsxs("div",{children:[e.jsx("div",{className:"text-xs text-muted-foreground",children:"Pista"}),e.jsxs("div",{className:"font-bold",children:[t.trackTemp,"Â°C"]})]})]}),e.jsxs("div",{className:"flex items-center gap-3 p-2 bg-muted/30 rounded",children:[e.jsx(D,{className:"h-5 w-5 text-blue-500"}),e.jsxs("div",{children:[e.jsx("div",{className:"text-xs text-muted-foreground",children:"Ar"}),e.jsxs("div",{className:"font-bold",children:[t.airTemp,"Â°C"]})]})]}),t.windSpeed&&e.jsxs("div",{className:"flex items-center gap-3 p-2 bg-muted/30 rounded",children:[e.jsx(le,{className:"h-5 w-5 text-teal-500"}),e.jsxs("div",{children:[e.jsx("div",{className:"text-xs text-muted-foreground",children:"Vento"}),e.jsxs("div",{className:"font-bold",children:[t.windSpeed," km/h"]})]})]})]})]}),t.description&&e.jsxs(i,{className:"glass-card",children:[e.jsx(d,{children:e.jsx(c,{className:"text-lg",children:"InformaÃ§Ãµes"})}),e.jsx(m,{children:e.jsx("p",{className:"text-sm text-muted-foreground leading-relaxed",children:t.description})})]}),t.requirement&&e.jsxs(i,{className:"glass-card border-yellow-500/30 bg-yellow-500/5",children:[e.jsx(d,{children:e.jsxs(c,{className:"text-lg flex items-center gap-2",children:[e.jsx(G,{className:"h-5 w-5 text-yellow-600"}),"Requisitos"]})}),e.jsx(m,{children:e.jsx("p",{className:"text-sm text-muted-foreground",children:t.requirement})})]})]})]})]}),e.jsx(v,{})]}):e.jsxs("div",{className:"min-h-screen bg-background",children:[e.jsx(b,{}),e.jsx("div",{className:"container py-8",children:e.jsxs("div",{className:"text-center",children:[e.jsx("h1",{className:"text-2xl font-bold mb-4",children:"Corrida nÃ£o encontrada"}),e.jsxs(u,{onClick:()=>y("/races"),children:[e.jsx(F,{className:"h-4 w-4 mr-2"}),"Voltar para corridas"]})]})}),e.jsx(v,{})]})};export{Ce as default};
